
## 1. Введение
Актуальность исследования связана с необходимостью оперативного и воспроизводимого преобразования неструктурированных клинических рекомендаций и научных публикаций в унифицированные шаблоны, онтологии и граф знаний для последующей генерации объяснимых планов лечения, доступных для врачей через интеграцию в городскую медицинскую систему без отдельной аутентификации в модуле.
Проблемная ситуация выражается в ручном поиске и интерпретации рекомендаций, вариативности трактовок, отсутствии контроля версий и недостаточной автоматизации, что повышает риски ошибок и усложняет повседневную практику врачей в учреждениях города N.
Цель концепции — спроектировать и описать модуль, реализующий конвейер «документ → шаблон → RDF/TTL → граф знаний → генерация плана лечения ЯМ → экспертная валидация → публикация через REST‑API» с управлением версиями, аудитом и соответствием нормативным требованиям для СППВР с применением ИИ.
Практическая значимость работы заключается в создании воспроизводимого и объяснимого механизма формирования планов лечения, сокращающего время и усилия врачей, повышающего качество клинических решений и обеспечивающего масштабирование на уровне городской экосистемы здравоохранения при соблюдении требований госзаказа и отказе от несертифицированного ПО в продуктивной среде.

## 2. Описание проблемы, цели, ограничения и приоритетные клиентские пути

### 2.1 Проблемы текущего состояния (AS IS)
Существующая практика в учреждениях города характеризуется ручным поиском клинических рекомендаций, чтением PDF/DOCX, неоднородной интерпретацией критериев применимости и отсутствием единого нормализованного представления знаний для дальнейшего машинного использования.
Нет единого онтологического слоя и графа знаний, обеспечивающих связность понятий по нозологиям, условиям, методам лечения и услугам, что затрудняет повторное использование знаний и автоматическую проверку актуальности и полноты.
Отсутствует встроенный в ИТ‑контур города модуль, обеспечивающий прослеживаемость от источника до конкретного элемента плана лечения, а также фиксирующий экспертные правки в графе с последующим дообучением собственной языковой модели.
Имеются риски задержек и рассинхронизации при обновлении рекомендаций, поскольку нет регламентированного конвейера версионирования шаблонов, триплетов, графа и итоговых планов лечения, связанного с журналированием и аудитом.

### 2.2 Цели концепции
Основная цель — создать модуль, который автоматически переводит неструктурированные клинические документы в унифицированные шаблоны и RDF/TTL, формирует граф знаний, использует собственную языковую модель для генерации объяснимых планов лечения, обеспечивает экспертную валидацию и публикует результаты через REST‑API для врачей‑пользователей базовой городской системы.
Задачи включают разработку шаблонов рекомендаций, конвертеров в триплеты, загрузчиков в граф, сервисов генерации планов лечения со step‑by‑step объяснимостью, средств экспертного редактирования узлов/рёбер и версионного аудита, а также проектирование API и нефункциональных требований по производительности, надёжности и безопасности.
Целевые эффекты: сокращение времени формирования плана лечения, повышение воспроизводимости и объяснимости решений, управление качеством и рисками, улучшение доступности и масштабируемости знаний на уровне города при согласованности с регуляторными нормами.

### 2.3 Ограничения концепции
Технологические ограничения: модуль интегрируется как компонент базовой городской системы и не осуществляет отдельную пользовательскую аутентификацию, опираясь на доверенный периметр и машинные учётные записи; в продуктивной среде недопустимо использование несертифицированного open source, а стек подбирается с учётом реестров и регламентов.
Правовые ограничения: обработка медицинских данных требует соблюдения ФЗ‑152, ведомственных приказов и стандартов СППВР, при этом результаты автоматизированной генерации носят рекомендательный характер и подлежат экспертной валидации до публикации в рабочие контуры.
Организационные ограничения: пилот ограничен рамками одного города N и несколькими учреждениями, ресурсы команды и сроки дипломного проекта накладывают ограничение на охват нозологий и глубину интеграций на первом этапе.
Ограничения точности и полноты: качество исходных документов и сложность нормализации приводят к необходимости итеративной настройки валидаторов, пополнения онтологии и циклового дообучения ЯМ с участием экспертов.

### 2.4 Приоритетные клиентские пути
2.4.1 Врач‑пользователь в городской системе  
AS IS: врач вручную ищет и интерпретирует разнородные документы, тратит значительное время и сталкивается с вариативностью трактовок без гарантий полноты и актуальности.
TO BE: врач по API базовой системы получает структурированный план лечения для заданной нозологии и профиля пациента с обоснованиями, ссылками на источники и отображением релевантного подграфа без входа в отдельный модуль.
Ключевые выгоды: экономия времени, повышение обоснованности решений, согласованность с клиническими рекомендациями и упрощение навигации по сложным правилам.

2.4.2 Врач‑эксперт (валидация и улучшение знаний)  
AS IS: экспертные комментарии остаются вне единого контура данных, что затрудняет обучение систем и накопление проверенных знаний.
TO BE: эксперт просматривает узлы/рёбра подграфа и текст плана, вносит правки, утверждает версии и запускает обратную интеграцию правок в обучающий контур ЯМ для повышения точности и полноты.
Ключевые выгоды: замыкание контура качества, снижение галлюцинаций, формирование проверенной базы знаний и улучшение последующих версий планов.

2.4.3 Администратор данных (обновления и контроль)  
AS IS: нет унифицированного механизма загрузки пакетов рекомендаций, контроля статусов парсинга, версий и аудита.
TO BE: администратор загружает пакеты, видит статусы и логи, отслеживает версии шаблонов, триплетов, графа и планов, формирует релизные отчёты соответствия нормам.
Ключевые выгоды: прозрачность, прослеживаемость и управляемость жизненного цикла знаний.

2.4.4 Интеграционная роль базовой городской системы  
AS IS: отсутствуют стандартизированные эндпоинты модуля для поиска и получения планов лечения в формате, удобном для встраивания в рабочие места врачей.
TO BE: базовая система вызывает REST‑эндпоинты модуля, получает структурированный JSON/HTML и фрагменты графа, обеспечивая единый пользовательский опыт без дублирования аутентификации.
Ключевые выгоды: упрощение интеграции, единообразие представления, снижение TCO внедрения.

### 2.5 SMART‑критерии целей системы
Specific: создать модуль преобразования клинических документов в шаблоны и граф знаний с генерацией объяснимых планов лечения и публикацией через REST‑API для городской системы.
Measurable: не менее 10 целевых нозологий в пилоте, ≥80% покрытие валидаторов шаблонов, среднее время ответа поискового API ≤1‑3 с, доля планов без правок эксперта ≥60% на эталонных кейсах пилота.
Achievable: доступно в рамках 7‑месячного плана диплома с итерациями по шаблонам, онтологии, графу, ЯМ и интеграции, используя согласованный стек и окружение города.
Relevant: адресует потребности врачей и администраторов города в объяснимых и актуальных рекомендациях, снижая нагрузку и риск ошибок.
Time‑bound: релиз v1.0 к окончанию 7‑го месяца с подготовкой пилота, отчётностью и комплектом документации для защиты.

## 3. Общее описание архитектуры

### 3.1 Функциональная архитектура
Функции организованы вокруг четырёх ключевых процессов: парсинг и нормализация в шаблоны, построение онтологии и графа знаний, генерация и экспертная валидация планов лечения, публикация и поиск через REST‑API для базовой системы.
Процесс 1 «Парсинг и нормализация» включает загрузку пакетов документов, извлечение сущностей (нозология, критерии, методы, услуги, условия, доказательность), заполнение шаблонов и первичную валидацию.
Процесс 2 «Онтология и граф» конвертирует шаблоны в RDF/TTL триплеты, загружает в графовую БД, строит подграфы по нозологиям и индексирует связи для быстрого поиска и визуализации.
Процесс 3 «Генерация и валидация» использует собственную ЯМ для формирования плана лечения со step‑by‑step объяснимостью, после чего врач‑эксперт редактирует узлы/рёбра и тексты, утверждая версии и замыкая контур RLHF.
Процесс 4 «Публикация и поиск» предоставляет REST‑эндпоинты для интеграции, возвращающие структурированный JSON, HTML‑таблицы и фрагменты графа под требования базовой системы.

### 3.2 ИТ‑архитектура (модель C4)
Контекст: модуль встроен в городскую медицинскую систему, взаимодействует с администраторами данных, врачами‑экспертами опосредованно через инструменты верификации, собственной ЯМ и внутренними хранилищами шаблонов/графа, а внешняя аутентификация и маршрутизация прав доступа делегированы базовой системе.
Контейнеры: сервис приёма и парсинга, сервис нормализации и валидаторов шаблонов, сервис онтологии и графа, сервис генерации планов (ЯМ), сервис публикации и поиска (REST), подсистема версионирования и аудита, подсистема журналирования и мониторинга.
Компоненты: экстракторы сущностей, конвертеры в RDF/TTL, загрузчики в граф, индексаторы подграфов, исполнитель генерации с объяснимостью, редактор экспертных правок, менеджер версий и связей «шаблон → триплеты → граф → план».
Код‑уровень: контракты API, схемы DTO, валидаторы, репозитории для реляционного и графового слоёв, профайлинг и кэширование точек узкого места, механизмы ретраев и идемпотентности для устойчивости.

### 3.3 Модель данных
Ключевые сущности: Recommendation (рекомендация, нозология, МКБ‑10, ссылки на источники, версии), Criterion (тип и значение: возраст, симптомы, противопоказания, временные рамки, дозы), Method (методы лечения и их параметры), Service (услуги/процедуры и коды), GraphNode/GraphEdge (концепты и связи), TreatmentPlan (сгенерированный план с обоснованиями и ссылками), ExpertChange (правки и комментарии).
Реляционный слой хранит шаблоны, версии, планы, связи с пользователями и журналами, а графовый слой хранит понятийные связи и правила выбора, обеспечивая быстрые подграфы и трассируемость до источников.
Версионирование обеспечивает восстановление полной цепочки артефактов и сопоставление с релизами, что критично для аудита и регуляторных проверок.

### 3.4 Инфраструктура
Среда пилота должна обеспечивать выделенные контуры для API, онтологического слоя и ЯМ‑сервиса, сетевую сегментацию, резервное копирование реляционного и графового слоёв, а также централизованное логирование и мониторинг.
Горизонтальное масштабирование применяется для API и парсинга, а расчётные мощности ЯМ масштабируются отдельно, что соответствует требованию отделимости вычислительной части от стора данных.

### 3.5 Архитектурные принципы
Разделение ответственности: каждый сервис выполняет строгую роль и взаимодействует по согласованным контрактам, упрощая тестирование и заменяемость компонентов.
Слабая связанность: взаимодействие через REST и асинхронные очереди минимизирует эффект каскадных изменений и повышает устойчивость.
Отказоустойчивость и graceful degradation: ретраи, идемпотентность, кэширование и работа с контрольными точками парсинга сохраняют доступность ключевых функций при сбоях.
Идемпотентность операций: повторная обработка документных пакетов и генерации планов не нарушает консистентность благодаря уникальным ключам и проверкам.
Производительность и масштабируемость: индексация, кэширование, асинхронность и профайлинг горячих путей обеспечивают SLA API и графовых запросов.
Безопасность и соответствие: требования регламентов учитываются на уровне проектирования и релизного контроля, а технические и организационные меры зафиксированы в политике.

## 4. Связность и интеграция

### 4.1 Интеграции с внешними системами
Интеграция с базовой городской медицинской системой реализована через REST‑эндпоинты модуля, возвращающие структурированные планы лечения и соответствующие представления без дублирования аутентификации на стороне модуля.
Источники клинических данных включают официальный портал рекомендаций и согласованные научные публикации, поставляемые в виде файлов для парсинга и нормализации в шаблоны.
Встроенные механизмы очередей, кэширования, лимитов и журналирования обеспечивают устойчивость интеграций и предсказуемость производительности.

### 4.2 Стандарты обмена данными
REST как основной стиль, JSON/HTML как целевые форматы выдачи, OpenAPI для контракта и автогенерации клиентов и схем встраивания в базовую систему.
Версионирование API через путь (например, /api/v1/…) обеспечивает обратную совместимость при расширении семантики эндпоинтов.

### 4.3 Исходящие интеграции и API
Export‑возможности включают выгрузку планов и связанных артефактов с параметрами фильтрации, пагинации и сортировки, а также выдачу указателей на фрагменты графа для встраиваемой визуализации.
Для отчётности и контроля готовятся релизные отчёты с показателями качества, журналами и ссылками на версии артефактов.

### 4.4 Схема взаимодействия компонентов
@startuml
title Упрощённый конвейер: Парсер → ЯМ → БД → Врач

actor "Источник документов" as Src
participant "Парсер\n(без валидации)" as Parser
participant "ЯМ\n(нормализация, граф,\nпланы лечения)" as LM
database "База данных\n(рекомендации/граф/планы)" as DB
participant "Базовая городская система\n(поиск врача)" as Host

== Ввод и парсинг ==
Src -> Parser: Передать документы (PDF/DOCX/HTML)
Parser -> Parser: Извлечь текст/сущности (сырой)
Parser -> LM: Отдать контент для обработки

== Обработка ЯМ ==
LM -> LM: Семантическая нормализация и валидация
LM -> LM: Построение графа знаний и планов лечения
LM -> DB: Сохранить рекомендации/граф/планы

== Поиск врачом ==
Host -> DB: Запрос по нозологии/критериям
DB --> Host: Выдать готовые рекомендации/план\n(+ ссылки/фрагмент графа при надобности)

@enduml

## 5. Принципы проектирования

### 5.1 Принцип разделения ответственности
Каждый модуль изолирует свои задачи: приём/парсинг, нормализация/валидация, онтология/граф, генерация/объяснимость, валидация/редактирование, публикация/поиск, версии/аудит.

### 5.2 Принцип слабой связанности
Сервисы взаимодействуют через REST и очереди, не зависят от внутренних структур данных других компонентов и могут масштабироваться независимо.

### 5.3 Принцип отказоустойчивости и graceful degradation
Ретраи, идемпотентные операции, кэширование и контрольные точки обеспечивают устойчивость при временных отказах инфраструктуры или источников.

### 5.4 Принцип идемпотентности операций
Повторная обработка одинаковых пакетов и генераций не приводит к дубликатам или нарушению целостности благодаря ключам, хешам и проверкам версий.

### 5.5 Принцип производительности и масштабируемости
Индексация подграфов, профилирование тяжёлых запросов, асинхронные очереди и кэш повышают throughput и уменьшают латентность.

### 5.6 Принцип безопасности и соответствия стандартам
Стандарты СППВР и защита ПДн учитываются в архитектуре, релизных практиках и эксплуатационных регламентах модуля.

## 6. Информационная безопасность

### 6.1 Нормативные требования
Применяются требования ГОСТ Р 71671‑2024 (СППВР с ИИ), ПНСТ 872‑2023 (разработка и клинические испытания СППВР), ФЗ‑152 (ПДн), ФЗ‑149 (информационные системы), ведомственные регламенты хранения медданных и внутренние стандарты города.

### 6.2 Технические меры защиты
Транспортное шифрование, сегментация сетей для БД, API и ЯМ, минимально необходимые права сервисных учёток, секреты во внешнем хранилище, контроль целостности артефактов.
Полное журналирование административных и сервисных действий, ретенция логов и неизменяемые релизные отчёты для аудита.

### 6.3 Организационные меры
Роли и регламенты доступа, процедуры релизного контроля, обучение персонала, регулярные аудиты соответствия и планы реагирования на инциденты.

### 6.4 Защита данных
Принцип минимизации данных, хранение в юрисдикции города/страны, регламент резервного копирования и восстановления, трассируемость доступа и изменений.

## 7. Экономическая эффективность

### 7.1 Структура затрат на разработку
В рамках дипломного проекта основные затраты — время команды и инфраструктура пилота, включая окружение для БД, графа, REST и вычислительных задач ЯМ с возможностью масштабирования при росте номенклатуры нозологий и потребителей API.

### 7.2 Экономическое обоснование проекта
Экономия времени врачей при формировании плана лечения и стандартизация применения рекомендаций снижают операционные издержки и повышают качество обслуживания на уровне города.

### 7.3 Потенциал внедрения
Результаты пилота могут быть масштабированы на большее число учреждений города, в том числе с расширением охвата нозологий и интеграций, не меняя базовой архитектуры и контрактов.

### 7.4 Оценка окупаемости
Окупаемость выражается в сокращении времени на обработку клинических сценариев и снижении числа корректировок благодаря накоплению проверенного графа знаний и улучшению генераций ЯМ.

### 7.5 Основные риски
Технологические риски: качество исходных документов, изменчивость форматов, нагрузка на графовые запросы и вычисления ЯМ — нивелируются валидаторами, профилингом и масштабированием.
Регуляторные риски: несоответствие требованиям и аудитам — нивелируются регистром проверок, релизными отчётами и политиками доступа.

